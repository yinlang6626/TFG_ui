<!DOCTYPE html>
<html lang="zh" class="futuristic-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音频克隆 | SYNCTALK AI</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/system.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/layout.css') }}">

    <!-- JavaScript模块 -->
    <script src="{{ url_for('static', filename='js/modules/theme-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/modules/audio-manager.js') }}"></script>
    <script src="{{ url_for('static', filename='js/modules/voice-clone-manager.js') }}"></script>

    <style>
        /* 页面特有的补充样式 */
        body {
            background: var(--bg-primary);
        }

        /* 语音克隆容器的额外间距 */
        #voiceCloneContainer {
            margin-top: var(--space-6);
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="neon-navbar">
        <a href="/" class="nav-brand">
            <span>SYNCTALK</span>
        </a>
        <ul class="nav-menu">
            <li><a href="/model_training" class="nav-link">训练模型</a></li>
            <li><a href="/video_generation" class="nav-link">视频生成</a></li>
            <li><a href="/audio_clone" class="nav-link active">音频克隆</a></li>
            <li><a href="/chat_system" class="nav-link">人机对话</a></li>
        </ul>
        <!-- 主题切换器 -->
        <button class="theme-toggle navbar-theme-toggle" data-theme-toggle aria-label="切换主题">
            <span class="theme-icon sun">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </span>
            <span class="theme-icon moon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2"/>
                </svg>
            </span>
            <span class="theme-tooltip">切换主题</span>
        </button>
    </nav>

    <div class="page-container">
        <div class="header-section">
            <h1 class="page-title">音频克隆</h1>
            <p class="page-subtitle">基于参考音频进行高质量语音克隆系统</p>
        </div>

        <!-- 语音克隆界面容器 -->
        <div id="voiceCloneContainer"></div>
    </div>

    <script>
        // 页面加载时初始化语音克隆界面
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // 使用 VoiceCloneManager 创建语音克隆界面
                window.VoiceCloneUtils.createVoiceCloneInterface({
                    containerId: 'voiceCloneContainer',
                    uploadTitle: '步骤 1: 上传参考音频',
                    selectTitle: '步骤 2: 选择参考音频',
                    cloneTitle: '步骤 3: 语音克隆',
                    onCloneComplete: function(result) {
                        console.log('语音克隆完成:', result);
                        // 可以在这里添加完成后的额外处理逻辑
                    }
                });

                console.log('[页面] 语音克隆界面初始化完成');
            } catch (error) {
                console.error('[页面] 初始化语音克隆界面失败:', error);

                // 如果初始化失败，显示错误信息
                const container = document.getElementById('voiceCloneContainer');
                if (container) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: var(--space-8);">
                            <div style="color: var(--neon-red); font-size: 4rem; margin-bottom: var(--space-4);">⚠️</div>
                            <h2 style="color: var(--text-primary); margin-bottom: var(--space-2);">页面初始化失败</h2>
                            <p style="color: var(--text-secondary); margin-bottom: var(--space-4);">
                                语音克隆组件加载失败，请检查网络连接或刷新页面重试
                            </p>
                            <button type="button" class="neon-btn neon-btn-primary" onclick="location.reload()">
                                刷新页面
                            </button>
                        </div>
                    `;
                }
            }
        });
    </script>
</body>
</html>